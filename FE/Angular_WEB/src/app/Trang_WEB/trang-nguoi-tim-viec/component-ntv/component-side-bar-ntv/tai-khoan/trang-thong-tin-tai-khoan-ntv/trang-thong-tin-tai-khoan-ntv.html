<div class="tai-khoan-container">

  <div class="field-card logo-card">
    <div class="field-header">
      <span><i class="bi bi-person-circle text-primary"></i> Ảnh đại diện</span>
      <button *ngIf="editingSection !== 'anh_dai_dien'" class="btn-edit" (click)="enableEdit('anh_dai_dien')">
        <i class="bi bi-pencil-square"></i> Sửa
      </button>
    </div>
    <div class="field-body">
      <div *ngIf="editingSection === 'anh_dai_dien'; else viewAvatar">
        <input type="file" (change)="chonAnhDaiDien($event)" accept="image/*" />
        <div *ngIf="previewAvatar" class="logo-preview">
          <img [src]="previewAvatar" alt="Preview" />
        </div>
        <div class="button-group">
          <button class="btn-save" (click)="saveEdit()">Lưu</button>
          <button class="btn-cancel" (click)="cancelEdit()">Hủy</button>
        </div>
      </div>
      <ng-template #viewAvatar>
        <img [src]="taoDuongDanAnh(thong_tin.nguoi_tim_viec.anh_dai_dien) || 'assets/avatar-default.png'"
          class="logo-preview" alt="Avatar" />
      </ng-template>
    </div>
  </div>

  <div class="grid-container">
    <ng-container *ngFor="let field of [
      {label:'Họ tên', key:'ho_ten', type:'text'},
      {label:'Email', key:'email', type:'email'},
      {label:'Số điện thoại', key:'dien_thoai', type:'text'},
      {label:'Ngày sinh', key:'ngay_sinh', type:'date'},
      {label:'Giới tính', key:'gioi_tinh', type:'select'},
      {label:'Địa chỉ', key:'dia_chi', type:'text'},
      {label:'Trình độ học vấn', key:'trinh_do_hoc_van', type:'select'}
    ]">
      <div class="field-card">
        <div class="field-header">
          <span>{{ field.label }}</span>
          <button *ngIf="editingSection !== field.key" class="btn-edit" (click)="enableEdit(field.key)">
            <i class="bi bi-pencil-square"></i> Sửa
          </button>
        </div>
        <div class="field-body">
          <ng-container *ngIf="editingSection === field.key; else viewField">
            <ng-container [ngSwitch]="field.type">
              <input *ngSwitchCase="'text'" [(ngModel)]="editingValues[field.key]" class="field-input" />
              <input *ngSwitchCase="'email'" type="email" [(ngModel)]="editingValues[field.key]" class="field-input" />
              <input *ngSwitchCase="'date'" type="date" [(ngModel)]="editingValues[field.key]" class="field-input" />
              <select *ngSwitchCase="'select'" [(ngModel)]="editingValues[field.key]" class="field-input">
                <option *ngIf="field.key==='gioi_tinh'" [value]="1">Nam</option>
                <option *ngIf="field.key==='gioi_tinh'" [value]="2">Nữ</option>
                <option *ngIf="field.key==='gioi_tinh'" [value]="3">Khác</option>

                <option *ngIf="field.key==='trinh_do_hoc_van'" [value]="1">THPT</option>
                <option *ngIf="field.key==='trinh_do_hoc_van'" [value]="2">Trung cấp</option>
                <option *ngIf="field.key==='trinh_do_hoc_van'" [value]="3">Cao đẳng</option>
                <option *ngIf="field.key==='trinh_do_hoc_van'" [value]="4">Đại học</option>
                <option *ngIf="field.key==='trinh_do_hoc_van'" [value]="5">Thạc sĩ</option>
                <option *ngIf="field.key==='trinh_do_hoc_van'" [value]="6">Tiến sĩ</option>
              </select>
            </ng-container>

            <div class="button-group">
              <button class="btn-save" (click)="saveEdit()">Lưu</button>
              <button class="btn-cancel" (click)="cancelEdit()">Hủy</button>
            </div>
          </ng-container>

          <ng-template #viewField>
            <span *ngIf="field.key==='gioi_tinh'">
              {{ thong_tin.gioi_tinh===1?'Nam':thong_tin.gioi_tinh===2?'Nữ':'Khác' }}
            </span>
            <span *ngIf="field.key==='trinh_do_hoc_van'">
              {{ thong_tin.trinh_do_hoc_van===1?'THPT':
              thong_tin.trinh_do_hoc_van===2?'Trung cấp':
              thong_tin.trinh_do_hoc_van===3?'Cao đẳng':
              thong_tin.trinh_do_hoc_van===4?'Đại học':
              thong_tin.trinh_do_hoc_van===5?'Thạc sĩ':'Tiến sĩ' }}
            </span>
            <span *ngIf="field.type==='text' || field.type==='email' || field.type==='date'">
              {{ thong_tin[field.key] || 'Chưa cập nhật' }}
            </span>
          </ng-template>
        </div>
      </div>
    </ng-container>
  </div>

</div>