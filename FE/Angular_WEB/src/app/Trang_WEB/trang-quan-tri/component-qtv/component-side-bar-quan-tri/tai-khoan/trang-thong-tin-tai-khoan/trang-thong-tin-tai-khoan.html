<div class="tai-khoan-container">

  <div class="field-card logo-card">
    <div class="field-header">
      <span><i class="bi bi-person-circle text-primary"></i> Ảnh đại diện</span>
      <button *ngIf="editingSection !== 'anh_dai_dien'" class="btn-edit" (click)="enableEdit('anh_dai_dien')">
        <i class="bi bi-pencil-square"></i> Sửa
      </button>
    </div>

    <div class="field-body">
      <div *ngIf="editingSection === 'anh_dai_dien'; else viewAvatar">
        <input type="file" (change)="chonAnhDaiDien($event)" accept="image/*" />
        <div *ngIf="previewAvatar" class="logo-preview">
          <img [src]="previewAvatar" alt="Preview" />
        </div>
        <div class="button-group">
          <button class="btn-save" (click)="saveEdit()">Lưu</button>
          <button class="btn-cancel" (click)="cancelEdit()">Hủy</button>
        </div>
      </div>

      <ng-template #viewAvatar>
        <img
          [src]="taoDuongDanAnh(thong_tin?.duong_dan_anh_dai_dien) || 'assets/avatar-default.png'"
          class="logo-preview"
          alt="Avatar" />
      </ng-template>
    </div>
  </div>

  <div class="grid-container">
    <ng-container *ngFor="let field of danhSachTruong">
      <div class="field-card">
        <div class="field-header">
          <span>{{ field.label }}</span>
          <button *ngIf="editingSection !== field.key" class="btn-edit" (click)="enableEdit(field.key)">
            <i class="bi bi-pencil-square"></i> Sửa
          </button>
        </div>

        <div class="field-body">
          <ng-container *ngIf="editingSection === field.key; else viewField">
            <ng-container [ngSwitch]="field.type">
              <input *ngSwitchCase="'text'" [(ngModel)]="editingValues[field.key]" class="field-input" />
              <input *ngSwitchCase="'email'" type="email" [(ngModel)]="editingValues[field.key]" class="field-input" />
              <input *ngSwitchCase="'date'" type="date" [(ngModel)]="editingValues[field.key]" class="field-input" />
            </ng-container>

            <div class="button-group">
              <button class="btn-save" (click)="saveEdit()">Lưu</button>
              <button class="btn-cancel" (click)="cancelEdit()">Hủy</button>
            </div>
          </ng-container>

          <ng-template #viewField>
            <span>{{ thong_tin[field.key] || 'Chưa cập nhật' }}</span>
          </ng-template>
        </div>
      </div>
    </ng-container>
  </div>

</div>
